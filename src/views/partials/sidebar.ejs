<aside class="sidebar">
  <div class="sidebar-header">
    <span class="sidebar-brand"><%= typeof siteName !== 'undefined' ? siteName : 'AppRevenue' %></span>
    <button class="mobile-close" onclick="toggleSidebar()">&times;</button>
  </div>

  <nav class="sidebar-nav">
    <div class="nav-section">
      <a href="/dashboard" class="nav-item <%= typeof activePage !== 'undefined' && activePage === 'dashboard' ? 'active' : '' %>">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
        <span>Dashboard</span>
      </a>
    </div>

    <% if (typeof apps !== 'undefined' && apps.length > 0) { %>
    <div class="nav-section">
      <div class="nav-section-title">Apps</div>
      <% apps.forEach(function(a) { %>
      <a href="/dashboard/app/<%= a._id %>" class="nav-item nav-item-sm <%= typeof currentApp !== 'undefined' && currentApp && currentApp._id && currentApp._id.toString() === a._id.toString() ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="5" y="2" width="14" height="20" rx="2"/><line x1="12" y1="18" x2="12" y2="18"/></svg>
        <span><%= a.name %></span>
      </a>
      <% }); %>
    </div>
    <% } %>

    <div class="nav-section">
      <div class="nav-section-title">Settings</div>
      <a href="/dashboard/settings/admob" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'settings-admob' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
        <span>AdMob</span>
      </a>
      <a href="/dashboard/settings/stripe" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'settings-stripe' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
        <span>Stripe</span>
      </a>
      <a href="/dashboard/settings/appstore" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'settings-appstore' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        <span>App Store</span>
      </a>
      <a href="/dashboard/settings/googleplay" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'settings-googleplay' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5,3 19,12 5,21 5,3"/></svg>
        <span>Google Play</span>
      </a>
    </div>

    <div class="nav-section">
      <div class="nav-section-title">Account</div>
      <a href="/dashboard/profile" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'profile' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
        <span>Profile</span>
      </a>
      <a href="/dashboard/billing" class="nav-item nav-item-sm <%= typeof activePage !== 'undefined' && activePage === 'billing' ? 'active' : '' %>">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="1" y="4" width="22" height="16" rx="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
        <span>Billing</span>
        <% if (typeof user !== 'undefined' && user.plan === 'pro') { %><span class="badge badge-pro" style="margin-left:auto;">PRO</span><% } %>
      </a>
    </div>
  </nav>

  <div class="sidebar-footer">
    <a href="/logout" class="nav-item">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16,17 21,12 16,7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
      <span>Logout</span>
    </a>
  </div>
</aside>

<!-- Mobile toggle button -->
<button class="mobile-toggle" onclick="toggleSidebar()" style="display:none;position:fixed;top:16px;left:16px;z-index:999;background:var(--glass-white);border:1px solid var(--glass-border);color:var(--text);width:40px;height:40px;border-radius:12px;align-items:center;justify-content:center;cursor:pointer;backdrop-filter:blur(16px);">
  <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
</button>

<style>
  .sidebar {
    position: fixed;
    top: 0;
    left: 0;
    width: var(--sidebar-width);
    height: 100vh;
    background: rgba(5,8,22,0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-right: 1px solid var(--glass-border);
    display: flex;
    flex-direction: column;
    z-index: 100;
    transition: transform 0.3s;
    overflow-y: auto;
  }
  .sidebar-header {
    padding: 24px 20px 20px;
    border-bottom: 1px solid var(--glass-border);
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .sidebar-brand {
    font-family: var(--font-display);
    font-size: 18px;
    font-weight: 700;
    background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }
  .mobile-close {
    display: none;
    background: none;
    border: none;
    color: var(--text-muted);
    font-size: 24px;
    cursor: pointer;
  }
  .sidebar-nav {
    flex: 1;
    padding: 12px 0;
  }
  .nav-section {
    padding: 4px 12px;
    margin-bottom: 4px;
  }
  .nav-section-title {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--text-muted);
    padding: 12px 12px 6px;
    font-weight: 600;
  }
  .nav-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 10px 12px;
    border-radius: 10px;
    color: var(--text-muted);
    text-decoration: none;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s;
  }
  .nav-item-sm { font-size: 13px; padding: 8px 12px; }
  .nav-item:hover {
    background: rgba(255,255,255,0.05);
    color: var(--text);
  }
  .nav-item.active {
    background: rgba(0,240,255,0.1);
    color: var(--neon-cyan);
    box-shadow: inset 3px 0 0 var(--neon-cyan);
  }
  .sidebar-footer {
    padding: 12px;
    border-top: 1px solid var(--glass-border);
  }
  @media (max-width: 768px) {
    .mobile-close { display: block; }
    .sidebar { width: 280px; }
  }
</style>
